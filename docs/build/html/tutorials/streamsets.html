
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>3 - Working with StreamSets &#8212; NI4AI Blog 0.1 documentation</title>
    
  <link href="../_static/css/theme.css" rel="stylesheet">
  <link href="../_static/css/index.ff1ffe594081f20da1ef19478df9384b.css" rel="stylesheet">

    
  <link rel="stylesheet"
    href="../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      

    
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../_static/css/blank.css" />
    
  <link rel="preload" as="script" href="../_static/js/index.be7d3bbb2ef33a8344ce.js">

    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>window.MathJax = {"tex": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true}, "options": {"ignoreHtmlClass": "tex2jax_ignore|mathjax_ignore|document", "processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <link rel="shortcut icon" href="../_static/tree.ico"/>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    
      
      <link rel="icon" sizes="16x16" href="../_static/_static/tree.png">
      
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    
    <div class="container-fluid" id="banner"></div>

    
    <nav class="navbar navbar-light navbar-expand-lg bg-light fixed-top bd-navbar" id="navbar-main"><div class="container-xl">

  <div id="navbar-start">
    
    

<a class="navbar-brand" href="../index.html">
  <img src="../_static/PingThings_logo_color.png" class="logo" alt="logo">
</a>


    
  </div>

  <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbar-collapsible" aria-controls="navbar-collapsible" aria-expanded="false" aria-label="Toggle navigation">
    <span class="navbar-toggler-icon"></span>
  </button>

  
  <div id="navbar-collapsible" class="col-lg-9 collapse navbar-collapse">
    <div id="navbar-center" class="mr-auto">
      
      <div class="navbar-center-item">
        <ul id="navbar-main-elements" class="navbar-nav">
    <li class="toctree-l1 nav-item">
 <a class="reference internal nav-link" href="../blog/index.html">
  Blog Posts
 </a>
</li>

<li class="toctree-l1 nav-item">
 <a class="reference internal nav-link" href="../workshops/index.html">
  Workshops
 </a>
</li>

    
    <li class="nav-item">
        <a class="nav-link nav-external" href="https://btrdb.readthedocs.io/en/latest/">API Docs<i class="fas fa-external-link-alt"></i></a>
    </li>
    
    <li class="nav-item">
        <a class="nav-link nav-external" href="https://github.com/PingThingsIO/ni4ai-notebooks/tree/main/tutorials">Tutorials<i class="fas fa-external-link-alt"></i></a>
    </li>
    
    <li class="nav-item">
        <a class="nav-link nav-external" href="https://www.pingthings.io/">PingThings<i class="fas fa-external-link-alt"></i></a>
    </li>
    
</ul>
      </div>
      
    </div>

    <div id="navbar-end">
      
      <div class="navbar-end-item">
        <ul id="navbar-icon-links" class="navbar-nav" aria-label="Icon Links">
        <li class="nav-item">
          <a class="nav-link" href="https://github.com/PingThingsIO/ni4ai-notebooks" rel="noopener" target="_blank" title="GitHub">
            <span><i class="fab fa-github-square"></i></span>
            <label class="sr-only">GitHub</label>
          </a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="https://www.pingthings.io/" rel="noopener" target="_blank" title="PingThings">
            <span><i class="fa"></i></span>
            <label class="sr-only">PingThings</label>
          </a>
        </li>
      </ul>
      </div>
      
    </div>
  </div>
</div>
    </nav>
    

    <div class="container-xl">
      <div class="row">
          
            
            <!-- Only show if we have sidebars configured, else just a small margin  -->
            <div class="col-12 col-md-3 bd-sidebar"><form class="bd-search d-flex align-items-center" action="../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search the docs ..." aria-label="Search the docs ..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main navigation">
  <div class="bd-toc-item active">
    
  </div>
</nav>
            </div>
            
          

          
          <div class="d-none d-xl-block col-xl-2 bd-toc">
            
              
              <div class="toc-item">
                
<div class="tocsection onthispage pt-5 pb-3">
    <i class="fas fa-list"></i> On this page
</div>

<nav id="bd-toc-nav">
    <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#Imports">
   Imports
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#Connect-To-Server">
   Connect To Server
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#Helper-Methods">
     Helper Methods
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#Viewing-Data">
     Viewing Data
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#Transforming-Data-to-Other-Formats">
     Transforming Data to Other Formats
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#Numpy-Arrays">
       Numpy Arrays
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#Pandas-Series">
       Pandas Series
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#Pandas-DataFrame">
       Pandas DataFrame
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#Dictionaries">
       Dictionaries
      </a>
     </li>
    </ul>
   </li>
  </ul>
 </li>
</ul>

</nav>
              </div>
              
              <div class="toc-item">
                
              </div>
              
            
          </div>
          

          
          
            
          
          <main class="col-12 col-md-9 col-xl-7 py-md-5 pl-md-5 pr-md-4 bd-content" role="main">
              
              <div>
                
  
<style>
/* CSS for nbsphinx extension */

/* remove conflicting styling from Sphinx themes */
div.nbinput.container div.prompt *,
div.nboutput.container div.prompt *,
div.nbinput.container div.input_area pre,
div.nboutput.container div.output_area pre,
div.nbinput.container div.input_area .highlight,
div.nboutput.container div.output_area .highlight {
    border: none;
    padding: 0;
    margin: 0;
    box-shadow: none;
}

div.nbinput.container > div[class*=highlight],
div.nboutput.container > div[class*=highlight] {
    margin: 0;
}

div.nbinput.container div.prompt *,
div.nboutput.container div.prompt * {
    background: none;
}

div.nboutput.container div.output_area .highlight,
div.nboutput.container div.output_area pre {
    background: unset;
}

div.nboutput.container div.output_area div.highlight {
    color: unset;  /* override Pygments text color */
}

/* avoid gaps between output lines */
div.nboutput.container div[class*=highlight] pre {
    line-height: normal;
}

/* input/output containers */
div.nbinput.container,
div.nboutput.container {
    display: -webkit-flex;
    display: flex;
    align-items: flex-start;
    margin: 0;
    width: 100%;
}
@media (max-width: 540px) {
    div.nbinput.container,
    div.nboutput.container {
        flex-direction: column;
    }
}

/* input container */
div.nbinput.container {
    padding-top: 5px;
}

/* last container */
div.nblast.container {
    padding-bottom: 5px;
}

/* input prompt */
div.nbinput.container div.prompt pre {
    color: #307FC1;
}

/* output prompt */
div.nboutput.container div.prompt pre {
    color: #BF5B3D;
}

/* all prompts */
div.nbinput.container div.prompt,
div.nboutput.container div.prompt {
    width: 4.5ex;
    padding-top: 5px;
    position: relative;
    user-select: none;
}

div.nbinput.container div.prompt > div,
div.nboutput.container div.prompt > div {
    position: absolute;
    right: 0;
    margin-right: 0.3ex;
}

@media (max-width: 540px) {
    div.nbinput.container div.prompt,
    div.nboutput.container div.prompt {
        width: unset;
        text-align: left;
        padding: 0.4em;
    }
    div.nboutput.container div.prompt.empty {
        padding: 0;
    }

    div.nbinput.container div.prompt > div,
    div.nboutput.container div.prompt > div {
        position: unset;
    }
}

/* disable scrollbars on prompts */
div.nbinput.container div.prompt pre,
div.nboutput.container div.prompt pre {
    overflow: hidden;
}

/* input/output area */
div.nbinput.container div.input_area,
div.nboutput.container div.output_area {
    -webkit-flex: 1;
    flex: 1;
    overflow: auto;
}
@media (max-width: 540px) {
    div.nbinput.container div.input_area,
    div.nboutput.container div.output_area {
        width: 100%;
    }
}

/* input area */
div.nbinput.container div.input_area {
    border: 1px solid #e0e0e0;
    border-radius: 2px;
    /*background: #f5f5f5;*/
}

/* override MathJax center alignment in output cells */
div.nboutput.container div[class*=MathJax] {
    text-align: left !important;
}

/* override sphinx.ext.imgmath center alignment in output cells */
div.nboutput.container div.math p {
    text-align: left;
}

/* standard error */
div.nboutput.container div.output_area.stderr {
    background: #fdd;
}

/* ANSI colors */
.ansi-black-fg { color: #3E424D; }
.ansi-black-bg { background-color: #3E424D; }
.ansi-black-intense-fg { color: #282C36; }
.ansi-black-intense-bg { background-color: #282C36; }
.ansi-red-fg { color: #E75C58; }
.ansi-red-bg { background-color: #E75C58; }
.ansi-red-intense-fg { color: #B22B31; }
.ansi-red-intense-bg { background-color: #B22B31; }
.ansi-green-fg { color: #00A250; }
.ansi-green-bg { background-color: #00A250; }
.ansi-green-intense-fg { color: #007427; }
.ansi-green-intense-bg { background-color: #007427; }
.ansi-yellow-fg { color: #DDB62B; }
.ansi-yellow-bg { background-color: #DDB62B; }
.ansi-yellow-intense-fg { color: #B27D12; }
.ansi-yellow-intense-bg { background-color: #B27D12; }
.ansi-blue-fg { color: #208FFB; }
.ansi-blue-bg { background-color: #208FFB; }
.ansi-blue-intense-fg { color: #0065CA; }
.ansi-blue-intense-bg { background-color: #0065CA; }
.ansi-magenta-fg { color: #D160C4; }
.ansi-magenta-bg { background-color: #D160C4; }
.ansi-magenta-intense-fg { color: #A03196; }
.ansi-magenta-intense-bg { background-color: #A03196; }
.ansi-cyan-fg { color: #60C6C8; }
.ansi-cyan-bg { background-color: #60C6C8; }
.ansi-cyan-intense-fg { color: #258F8F; }
.ansi-cyan-intense-bg { background-color: #258F8F; }
.ansi-white-fg { color: #C5C1B4; }
.ansi-white-bg { background-color: #C5C1B4; }
.ansi-white-intense-fg { color: #A1A6B2; }
.ansi-white-intense-bg { background-color: #A1A6B2; }

.ansi-default-inverse-fg { color: #FFFFFF; }
.ansi-default-inverse-bg { background-color: #000000; }

.ansi-bold { font-weight: bold; }
.ansi-underline { text-decoration: underline; }


div.nbinput.container div.input_area div[class*=highlight] > pre,
div.nboutput.container div.output_area div[class*=highlight] > pre,
div.nboutput.container div.output_area div[class*=highlight].math,
div.nboutput.container div.output_area.rendered_html,
div.nboutput.container div.output_area > div.output_javascript,
div.nboutput.container div.output_area:not(.rendered_html) > img{
    padding: 5px;
    margin: 0;
}

/* fix copybtn overflow problem in chromium (needed for 'sphinx_copybutton') */
div.nbinput.container div.input_area > div[class^='highlight'],
div.nboutput.container div.output_area > div[class^='highlight']{
    overflow-y: hidden;
}

/* hide copybtn icon on prompts (needed for 'sphinx_copybutton') */
.prompt a.copybtn {
    display: none;
}

/* Some additional styling taken form the Jupyter notebook CSS */
div.rendered_html table {
  border: none;
  border-collapse: collapse;
  border-spacing: 0;
  color: black;
  font-size: 12px;
  table-layout: fixed;
}
div.rendered_html thead {
  border-bottom: 1px solid black;
  vertical-align: bottom;
}
div.rendered_html tr,
div.rendered_html th,
div.rendered_html td {
  text-align: right;
  vertical-align: middle;
  padding: 0.5em 0.5em;
  line-height: normal;
  white-space: normal;
  max-width: none;
  border: none;
}
div.rendered_html th {
  font-weight: bold;
}
div.rendered_html tbody tr:nth-child(odd) {
  background: #f5f5f5;
}
div.rendered_html tbody tr:hover {
  background: rgba(66, 165, 245, 0.2);
}
</style>
<section id="3---Working-with-StreamSets">
<h1>3 - Working with StreamSets<a class="headerlink" href="#3---Working-with-StreamSets" title="Permalink to this headline">¶</a></h1>
<p>The previous tutorial demonstrated how to retrieve data from individual streams.</p>
<p>Here, we pull data from groups of streams known as <code class="docutils literal notranslate"><span class="pre">StreamSet</span></code> objects. You can think of a <code class="docutils literal notranslate"><span class="pre">StreamSet</span></code> as a wrapper around a list of <code class="docutils literal notranslate"><span class="pre">Stream</span></code> objects that simplifies workflows like getting data into a dataframe, or time-aligning values across streams.</p>
<p>The StreamSet class has a number of methods to mirror those found in regular Stream objects including methods for transforming and serializing the data to different formats.</p>
<p>As with a <code class="docutils literal notranslate"><span class="pre">Stream</span></code>, retrieving data from the BTrDB server will fully materialize in memory so please keep this in mind. In other words, do not attempt to retreive data that is greater than the amount of memory available to you.</p>
<section id="Imports">
<h2>Imports<a class="headerlink" href="#Imports" title="Permalink to this headline">¶</a></h2>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[1]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span>import btrdb
from btrdb.stream import StreamSet
from tabulate import tabulate
from btrdb.utils.timez import ns_delta
</pre></div>
</div>
</div>
</section>
<section id="Connect-To-Server">
<h2>Connect To Server<a class="headerlink" href="#Connect-To-Server" title="Permalink to this headline">¶</a></h2>
<p>To get started we’ll connect to the server and define a helper method from a previous notebook.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[2]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span># Make sure you add your API key to the config file to connect!
conn = btrdb.connect()
conn.info()
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[2]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
{&#39;majorVersion&#39;: 5, &#39;build&#39;: &#39;5.11.157&#39;, &#39;proxy&#39;: {&#39;proxyEndpoints&#39;: []}}
</pre></div></div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[3]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span>def describe_streams(streams):
    table = [[&quot;Collection&quot;, &quot;Name&quot;, &quot;Units&quot;, &quot;Version&quot;, &quot;Earliest&quot;, &quot;Latest&quot;]]
    for stream in streams:
        tags = stream.tags()
        table.append([
            stream.collection, stream.name, tags[&quot;unit&quot;], stream.version(),
            stream.earliest()[0].time, stream.latest()[0].time,
        ])
    return tabulate(table, headers=&quot;firstrow&quot;)
</pre></div>
</div>
</div>
<section id="Helper-Methods">
<h3>Helper Methods<a class="headerlink" href="#Helper-Methods" title="Permalink to this headline">¶</a></h3>
<p>The best way to think about the <code class="docutils literal notranslate"><span class="pre">StreamSet</span></code> is as a wrapper around a list of <code class="docutils literal notranslate"><span class="pre">Stream</span></code> objects with appropriate methods added to help with examining your data. To create a <code class="docutils literal notranslate"><span class="pre">StreamSet</span></code> we can just pass in a list of streams, which we will obtain by selecting a few current streams from the database.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span>streams = conn.streams_in_collection(&#39;sunshine/PMU1&#39;, tags={&quot;unit&quot;: &quot;amps&quot;})
streamset = StreamSet(streams)
print(describe_streams(streamset))
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Collection     Name    Units      Version             Earliest               Latest
-------------  ------  -------  ---------  -------------------  -------------------
sunshine/PMU1  C3MAG   amps        240481  1443715704008333000  1492220199333333000
sunshine/PMU1  C2MAG   amps        240718  1443715704008333000  1492220199333333000
sunshine/PMU1  C1MAG   amps        240380  1443715704008333000  1492220495999999000
</pre></div></div>
</div>
<p>Now that we have a StreamSet with the three streams, let’s take a look at some of the helper methods. In a Stream object, the <code class="docutils literal notranslate"><span class="pre">earliest</span></code> method would provide the first point in the Stream. <code class="docutils literal notranslate"><span class="pre">StreamSet.earliest</span></code> will provide a tuple containing the first points from each individual stream. The order is the same as the UUIDs that were provided when creating the instance.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[5]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span>streamset.earliest()
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[5]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
(RawPoint(1443715704008333000, 0.14318889379501343),
 RawPoint(1443715704008333000, 0.14414265751838684),
 RawPoint(1443715704008333000, 0.14462821185588837))
</pre></div></div>
</div>
<p>Similarly, let’s look at the latest points in the streams.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[6]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span>streamset.latest()
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[6]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
(RawPoint(1492220199333333000, 19.179134368896484),
 RawPoint(1492220199333333000, 23.198545455932617),
 RawPoint(1492220495999999000, 20.29911994934082))
</pre></div></div>
</div>
</section>
<section id="Viewing-Data">
<h3>Viewing Data<a class="headerlink" href="#Viewing-Data" title="Permalink to this headline">¶</a></h3>
<p>Like the <code class="docutils literal notranslate"><span class="pre">Stream</span></code> object, the <code class="docutils literal notranslate"><span class="pre">StreamSet</span></code> has a <code class="docutils literal notranslate"><span class="pre">values</span></code> method which will return a list of lists. Each internal list contains the <code class="docutils literal notranslate"><span class="pre">RawPoint</span></code> instances for a given stream. Just as before we will return only a little bit of the data from the beginning of the streams.</p>
<p>We will start by finding the earliest time from all of the earliest points although in this case they all have the same beginning time.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[7]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span>earliest_point = sorted(streamset.earliest(), key=lambda p: p.time)[0]
earliest_point.time
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[7]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
1443715704008333000
</pre></div></div>
</div>
<p>Next we will ask for the values in the streams. Stream values are returned as a list of list of points such that the lists of points are ordered according to the UUIDs provided on initialization. Using this method data is fetched for each stream and returned and can be thought of as a helper method to query multiple streams simultaneously.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[8]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span>start = earliest_point.time
end = start + ns_delta(milliseconds=100)
streamset.filter(start, end).values()
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[8]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
[[RawPoint(1443715704008333000, 0.14318889379501343),
  RawPoint(1443715704016666000, 0.14324119687080383),
  RawPoint(1443715704024999000, 0.14320218563079834),
  RawPoint(1443715704033333000, 0.14330747723579407),
  RawPoint(1443715704041666000, 0.14341890811920166),
  RawPoint(1443715704049999000, 0.1432417333126068),
  RawPoint(1443715704058333000, 0.14306816458702087),
  RawPoint(1443715704066666000, 0.14304737746715546),
  RawPoint(1443715704074999000, 0.14306952059268951),
  RawPoint(1443715704083333000, 0.14308595657348633),
  RawPoint(1443715704091666000, 0.1431303173303604),
  RawPoint(1443715704099999000, 0.14315181970596313)],
 [RawPoint(1443715704008333000, 0.14414265751838684),
  RawPoint(1443715704016666000, 0.14403386414051056),
  RawPoint(1443715704024999000, 0.14402998983860016),
  RawPoint(1443715704033333000, 0.14409348368644714),
  RawPoint(1443715704041666000, 0.14425787329673767),
  RawPoint(1443715704049999000, 0.1443229466676712),
  RawPoint(1443715704058333000, 0.14423619210720062),
  RawPoint(1443715704066666000, 0.1443118453025818),
  RawPoint(1443715704074999000, 0.14431005716323853),
  RawPoint(1443715704083333000, 0.14416487514972687),
  RawPoint(1443715704091666000, 0.14408448338508606),
  RawPoint(1443715704099999000, 0.1440746784210205)],
 [RawPoint(1443715704008333000, 0.14462821185588837),
  RawPoint(1443715704016666000, 0.144479438662529),
  RawPoint(1443715704024999000, 0.14440062642097473),
  RawPoint(1443715704033333000, 0.14451566338539124),
  RawPoint(1443715704041666000, 0.14469324052333832),
  RawPoint(1443715704049999000, 0.14457932114601135),
  RawPoint(1443715704058333000, 0.14438524842262268),
  RawPoint(1443715704066666000, 0.14439848065376282),
  RawPoint(1443715704074999000, 0.14448127150535583),
  RawPoint(1443715704083333000, 0.14456181228160858),
  RawPoint(1443715704091666000, 0.14456859230995178),
  RawPoint(1443715704099999000, 0.14451190829277039)]]
</pre></div></div>
</div>
<p>You may have noticed that we first called the <code class="docutils literal notranslate"><span class="pre">filter</span></code> method and then called the <code class="docutils literal notranslate"><span class="pre">values</span></code> method with no arguments. The <code class="docutils literal notranslate"><span class="pre">StreamSet</span></code> class was designed to support a method chaining style of programming and so behaves slightly differently from the <code class="docutils literal notranslate"><span class="pre">Stream</span></code>.</p>
<p>Data is only ever materialized when calling the <code class="docutils literal notranslate"><span class="pre">values</span></code> or <code class="docutils literal notranslate"><span class="pre">rows</span></code> method as demonstrated below. The <code class="docutils literal notranslate"><span class="pre">rows</span></code> method is similar to the <code class="docutils literal notranslate"><span class="pre">values</span></code> method but orients the data differently. Here you will notice that the streams are aligned according to time. The first tuple contains all of the data for the first time index. If any streams do not have data at that time index, then <code class="docutils literal notranslate"><span class="pre">None</span></code> is used as a placeholder.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[9]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span>streamset.filter(start, end).rows()
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[9]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
[(RawPoint(1443715704008333000, 0.14318889379501343),
  RawPoint(1443715704008333000, 0.14414265751838684),
  RawPoint(1443715704008333000, 0.14462821185588837)),
 (RawPoint(1443715704016666000, 0.14324119687080383),
  RawPoint(1443715704016666000, 0.14403386414051056),
  RawPoint(1443715704016666000, 0.144479438662529)),
 (RawPoint(1443715704024999000, 0.14320218563079834),
  RawPoint(1443715704024999000, 0.14402998983860016),
  RawPoint(1443715704024999000, 0.14440062642097473)),
 (RawPoint(1443715704033333000, 0.14330747723579407),
  RawPoint(1443715704033333000, 0.14409348368644714),
  RawPoint(1443715704033333000, 0.14451566338539124)),
 (RawPoint(1443715704041666000, 0.14341890811920166),
  RawPoint(1443715704041666000, 0.14425787329673767),
  RawPoint(1443715704041666000, 0.14469324052333832)),
 (RawPoint(1443715704049999000, 0.1432417333126068),
  RawPoint(1443715704049999000, 0.1443229466676712),
  RawPoint(1443715704049999000, 0.14457932114601135)),
 (RawPoint(1443715704058333000, 0.14306816458702087),
  RawPoint(1443715704058333000, 0.14423619210720062),
  RawPoint(1443715704058333000, 0.14438524842262268)),
 (RawPoint(1443715704066666000, 0.14304737746715546),
  RawPoint(1443715704066666000, 0.1443118453025818),
  RawPoint(1443715704066666000, 0.14439848065376282)),
 (RawPoint(1443715704074999000, 0.14306952059268951),
  RawPoint(1443715704074999000, 0.14431005716323853),
  RawPoint(1443715704074999000, 0.14448127150535583)),
 (RawPoint(1443715704083333000, 0.14308595657348633),
  RawPoint(1443715704083333000, 0.14416487514972687),
  RawPoint(1443715704083333000, 0.14456181228160858)),
 (RawPoint(1443715704091666000, 0.1431303173303604),
  RawPoint(1443715704091666000, 0.14408448338508606),
  RawPoint(1443715704091666000, 0.14456859230995178)),
 (RawPoint(1443715704099999000, 0.14315181970596313),
  RawPoint(1443715704099999000, 0.1440746784210205),
  RawPoint(1443715704099999000, 0.14451190829277039))]
</pre></div></div>
</div>
<p>Let’s use the tabulate library again to better format the data rows.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[10]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span>table = [[&quot;time&quot;] + [s.name for s in streamset]]

for row in streamset.filter(start, end).rows():
    time = sorted([p.time for p in row])[-1]
    data = [time]
    for point in row:
        data.append(point.value)
    table.append(data)

print(tabulate(table, headers=&quot;firstrow&quot;))
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
               time     C3MAG     C2MAG     C1MAG
-------------------  --------  --------  --------
1443715704008333000  0.143189  0.144143  0.144628
1443715704016666000  0.143241  0.144034  0.144479
1443715704024999000  0.143202  0.14403   0.144401
1443715704033333000  0.143307  0.144093  0.144516
1443715704041666000  0.143419  0.144258  0.144693
1443715704049999000  0.143242  0.144323  0.144579
1443715704058333000  0.143068  0.144236  0.144385
1443715704066666000  0.143047  0.144312  0.144398
1443715704074999000  0.14307   0.14431   0.144481
1443715704083333000  0.143086  0.144165  0.144562
1443715704091666000  0.14313   0.144084  0.144569
1443715704099999000  0.143152  0.144075  0.144512
</pre></div></div>
</div>
</section>
<section id="Transforming-Data-to-Other-Formats">
<h3>Transforming Data to Other Formats<a class="headerlink" href="#Transforming-Data-to-Other-Formats" title="Permalink to this headline">¶</a></h3>
<p>A number of methods have been provided to convert the point data objects into objects you may already be familiar with such as numpy arrays and pandas dataframes. Using these transformation methods materializes the data similar to the <code class="docutils literal notranslate"><span class="pre">values</span></code> method. Examples of the available transformations follow.</p>
<section id="Numpy-Arrays">
<h4>Numpy Arrays<a class="headerlink" href="#Numpy-Arrays" title="Permalink to this headline">¶</a></h4>
<p>Converting to Numpy arrays will produce a list of arrays. This output will be similar in structure to calling the <code class="docutils literal notranslate"><span class="pre">values</span></code> method.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[11]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span>start = earliest_point.time
end = start + ns_delta(milliseconds=100)

streamset.filter(start, end).to_array()
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[11]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
array([[0.14318889, 0.1432412 , 0.14320219, 0.14330748, 0.14341891,
        0.14324173, 0.14306816, 0.14304738, 0.14306952, 0.14308596,
        0.14313032, 0.14315182],
       [0.14414266, 0.14403386, 0.14402999, 0.14409348, 0.14425787,
        0.14432295, 0.14423619, 0.14431185, 0.14431006, 0.14416488,
        0.14408448, 0.14407468],
       [0.14462821, 0.14447944, 0.14440063, 0.14451566, 0.14469324,
        0.14457932, 0.14438525, 0.14439848, 0.14448127, 0.14456181,
        0.14456859, 0.14451191]])
</pre></div></div>
</div>
</section>
<section id="Pandas-Series">
<h4>Pandas Series<a class="headerlink" href="#Pandas-Series" title="Permalink to this headline">¶</a></h4>
<p>Converting to a pandas series will produce a view of the data similar to calling the <code class="docutils literal notranslate"><span class="pre">values</span></code> method. The resulting series will be indexed by time.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[12]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span>streamset.filter(start, end).to_series()
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[12]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
[2015-10-01 16:08:24.008333    0.143189
 2015-10-01 16:08:24.016666    0.143241
 2015-10-01 16:08:24.024999    0.143202
 2015-10-01 16:08:24.033333    0.143307
 2015-10-01 16:08:24.041666    0.143419
 2015-10-01 16:08:24.049999    0.143242
 2015-10-01 16:08:24.058333    0.143068
 2015-10-01 16:08:24.066666    0.143047
 2015-10-01 16:08:24.074999    0.143070
 2015-10-01 16:08:24.083333    0.143086
 2015-10-01 16:08:24.091666    0.143130
 2015-10-01 16:08:24.099999    0.143152
 Name: sunshine/PMU1/C3MAG, dtype: float64,
 2015-10-01 16:08:24.008333    0.144143
 2015-10-01 16:08:24.016666    0.144034
 2015-10-01 16:08:24.024999    0.144030
 2015-10-01 16:08:24.033333    0.144093
 2015-10-01 16:08:24.041666    0.144258
 2015-10-01 16:08:24.049999    0.144323
 2015-10-01 16:08:24.058333    0.144236
 2015-10-01 16:08:24.066666    0.144312
 2015-10-01 16:08:24.074999    0.144310
 2015-10-01 16:08:24.083333    0.144165
 2015-10-01 16:08:24.091666    0.144084
 2015-10-01 16:08:24.099999    0.144075
 Name: sunshine/PMU1/C2MAG, dtype: float64,
 2015-10-01 16:08:24.008333    0.144628
 2015-10-01 16:08:24.016666    0.144479
 2015-10-01 16:08:24.024999    0.144401
 2015-10-01 16:08:24.033333    0.144516
 2015-10-01 16:08:24.041666    0.144693
 2015-10-01 16:08:24.049999    0.144579
 2015-10-01 16:08:24.058333    0.144385
 2015-10-01 16:08:24.066666    0.144398
 2015-10-01 16:08:24.074999    0.144481
 2015-10-01 16:08:24.083333    0.144562
 2015-10-01 16:08:24.091666    0.144569
 2015-10-01 16:08:24.099999    0.144512
 Name: sunshine/PMU1/C1MAG, dtype: float64]
</pre></div></div>
</div>
</section>
<section id="Pandas-DataFrame">
<h4>Pandas DataFrame<a class="headerlink" href="#Pandas-DataFrame" title="Permalink to this headline">¶</a></h4>
<p>Converting to a pandas dataframe will produce a tabular view of the data similar to calling the <code class="docutils literal notranslate"><span class="pre">rows</span></code> method. The resulting dataframe will be indexed by time.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[13]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span>streamset.filter(start, end).to_dataframe()
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[13]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>sunshine/PMU1/C3MAG</th>
      <th>sunshine/PMU1/C2MAG</th>
      <th>sunshine/PMU1/C1MAG</th>
    </tr>
    <tr>
      <th>time</th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1443715704008333000</th>
      <td>0.143189</td>
      <td>0.144143</td>
      <td>0.144628</td>
    </tr>
    <tr>
      <th>1443715704016666000</th>
      <td>0.143241</td>
      <td>0.144034</td>
      <td>0.144479</td>
    </tr>
    <tr>
      <th>1443715704024999000</th>
      <td>0.143202</td>
      <td>0.144030</td>
      <td>0.144401</td>
    </tr>
    <tr>
      <th>1443715704033333000</th>
      <td>0.143307</td>
      <td>0.144093</td>
      <td>0.144516</td>
    </tr>
    <tr>
      <th>1443715704041666000</th>
      <td>0.143419</td>
      <td>0.144258</td>
      <td>0.144693</td>
    </tr>
    <tr>
      <th>1443715704049999000</th>
      <td>0.143242</td>
      <td>0.144323</td>
      <td>0.144579</td>
    </tr>
    <tr>
      <th>1443715704058333000</th>
      <td>0.143068</td>
      <td>0.144236</td>
      <td>0.144385</td>
    </tr>
    <tr>
      <th>1443715704066666000</th>
      <td>0.143047</td>
      <td>0.144312</td>
      <td>0.144398</td>
    </tr>
    <tr>
      <th>1443715704074999000</th>
      <td>0.143070</td>
      <td>0.144310</td>
      <td>0.144481</td>
    </tr>
    <tr>
      <th>1443715704083333000</th>
      <td>0.143086</td>
      <td>0.144165</td>
      <td>0.144562</td>
    </tr>
    <tr>
      <th>1443715704091666000</th>
      <td>0.143130</td>
      <td>0.144084</td>
      <td>0.144569</td>
    </tr>
    <tr>
      <th>1443715704099999000</th>
      <td>0.143152</td>
      <td>0.144075</td>
      <td>0.144512</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
</section>
<section id="Dictionaries">
<h4>Dictionaries<a class="headerlink" href="#Dictionaries" title="Permalink to this headline">¶</a></h4>
<p>Converting to Python dictionaries produces a list of <code class="docutils literal notranslate"><span class="pre">OrderedDicts</span></code> similar to calling the <code class="docutils literal notranslate"><span class="pre">rows</span></code> method.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[14]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span>streamset.filter(start, end).to_dict()
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[14]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
[OrderedDict([(&#39;time&#39;, 1443715704008333000),
              (&#39;sunshine/PMU1/C3MAG&#39;, 0.14318889379501343),
              (&#39;sunshine/PMU1/C2MAG&#39;, 0.14414265751838684),
              (&#39;sunshine/PMU1/C1MAG&#39;, 0.14462821185588837)]),
 OrderedDict([(&#39;time&#39;, 1443715704016666000),
              (&#39;sunshine/PMU1/C3MAG&#39;, 0.14324119687080383),
              (&#39;sunshine/PMU1/C2MAG&#39;, 0.14403386414051056),
              (&#39;sunshine/PMU1/C1MAG&#39;, 0.144479438662529)]),
 OrderedDict([(&#39;time&#39;, 1443715704024999000),
              (&#39;sunshine/PMU1/C3MAG&#39;, 0.14320218563079834),
              (&#39;sunshine/PMU1/C2MAG&#39;, 0.14402998983860016),
              (&#39;sunshine/PMU1/C1MAG&#39;, 0.14440062642097473)]),
 OrderedDict([(&#39;time&#39;, 1443715704033333000),
              (&#39;sunshine/PMU1/C3MAG&#39;, 0.14330747723579407),
              (&#39;sunshine/PMU1/C2MAG&#39;, 0.14409348368644714),
              (&#39;sunshine/PMU1/C1MAG&#39;, 0.14451566338539124)]),
 OrderedDict([(&#39;time&#39;, 1443715704041666000),
              (&#39;sunshine/PMU1/C3MAG&#39;, 0.14341890811920166),
              (&#39;sunshine/PMU1/C2MAG&#39;, 0.14425787329673767),
              (&#39;sunshine/PMU1/C1MAG&#39;, 0.14469324052333832)]),
 OrderedDict([(&#39;time&#39;, 1443715704049999000),
              (&#39;sunshine/PMU1/C3MAG&#39;, 0.1432417333126068),
              (&#39;sunshine/PMU1/C2MAG&#39;, 0.1443229466676712),
              (&#39;sunshine/PMU1/C1MAG&#39;, 0.14457932114601135)]),
 OrderedDict([(&#39;time&#39;, 1443715704058333000),
              (&#39;sunshine/PMU1/C3MAG&#39;, 0.14306816458702087),
              (&#39;sunshine/PMU1/C2MAG&#39;, 0.14423619210720062),
              (&#39;sunshine/PMU1/C1MAG&#39;, 0.14438524842262268)]),
 OrderedDict([(&#39;time&#39;, 1443715704066666000),
              (&#39;sunshine/PMU1/C3MAG&#39;, 0.14304737746715546),
              (&#39;sunshine/PMU1/C2MAG&#39;, 0.1443118453025818),
              (&#39;sunshine/PMU1/C1MAG&#39;, 0.14439848065376282)]),
 OrderedDict([(&#39;time&#39;, 1443715704074999000),
              (&#39;sunshine/PMU1/C3MAG&#39;, 0.14306952059268951),
              (&#39;sunshine/PMU1/C2MAG&#39;, 0.14431005716323853),
              (&#39;sunshine/PMU1/C1MAG&#39;, 0.14448127150535583)]),
 OrderedDict([(&#39;time&#39;, 1443715704083333000),
              (&#39;sunshine/PMU1/C3MAG&#39;, 0.14308595657348633),
              (&#39;sunshine/PMU1/C2MAG&#39;, 0.14416487514972687),
              (&#39;sunshine/PMU1/C1MAG&#39;, 0.14456181228160858)]),
 OrderedDict([(&#39;time&#39;, 1443715704091666000),
              (&#39;sunshine/PMU1/C3MAG&#39;, 0.1431303173303604),
              (&#39;sunshine/PMU1/C2MAG&#39;, 0.14408448338508606),
              (&#39;sunshine/PMU1/C1MAG&#39;, 0.14456859230995178)]),
 OrderedDict([(&#39;time&#39;, 1443715704099999000),
              (&#39;sunshine/PMU1/C3MAG&#39;, 0.14315181970596313),
              (&#39;sunshine/PMU1/C2MAG&#39;, 0.1440746784210205),
              (&#39;sunshine/PMU1/C1MAG&#39;, 0.14451190829277039)])]
</pre></div></div>
</div>
</section>
</section>
</section>
</section>


              </div>
              
              
              <!-- Previous / next buttons -->
<div class='prev-next-area'>
</div>
              
          </main>
          

      </div>
    </div>
  
  <script src="../_static/js/index.be7d3bbb2ef33a8344ce.js"></script>
<footer class="footer mt-5 mt-md-0">
  <div class="container">
    
    <div class="footer-item">
      <p class="copyright">
    &copy; Copyright 2021, PingThings.<br>
</p>
    </div>
    
    <div class="footer-item">
      <p class="sphinx-version">
Created using <a href="http://sphinx-doc.org/">Sphinx</a> 4.3.0.<br>
</p>
    </div>
    
  </div>
</footer>
  </body>
</html>